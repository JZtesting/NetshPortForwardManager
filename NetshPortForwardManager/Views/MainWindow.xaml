<Window x:Class="NetshPortForwardManager.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="NetSh Port Forward Manager" Height="600" Width="900"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0">
            <MenuItem Header="_File">
                <MenuItem Header="_Import Rules..." Click="ImportRules_Click"/>
                <MenuItem Header="_Export Rules..." Click="ExportRules_Click"/>
                <Separator/>
                <MenuItem Header="E_xit" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Add Rule" Click="AddRule_Click"/>
                <MenuItem Header="_Edit Rule" Click="EditRule_Click"/>
                <MenuItem Header="_Delete Rule" Click="DeleteRule_Click"/>
                <Separator/>
                <MenuItem Header="_Reset All Rules" Click="ResetAllRules_Click"/>
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="_Refresh" Click="Refresh_Click"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_About" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <ToolBar Grid.Row="1">
            <Button Name="AddRuleButton" Content="Add Rule" Click="AddRule_Click" Padding="10,5"/>
            <Button Name="EditRuleButton" Content="Edit Rule" Click="EditRule_Click" Padding="10,5" IsEnabled="{Binding HasSelectedRule}"/>
            <Button Name="DeleteRuleButton" Content="Delete Rule" Click="DeleteRule_Click" Padding="10,5" IsEnabled="{Binding HasSelectedRule}"/>
            <Separator/>
            <Button Name="RefreshButton" Content="Refresh" Click="Refresh_Click" Padding="10,5"/>
            <Separator/>
            <Button Name="ImportButton" Content="Import" Click="ImportRules_Click" Padding="10,5"/>
            <Button Name="ExportButton" Content="Export" Click="ExportRules_Click" Padding="10,5"/>
        </ToolBar>

        <!-- Main Content -->
        <DataGrid Grid.Row="2" Name="RulesDataGrid" 
                  ItemsSource="{Binding Rules}"
                  SelectedItem="{Binding SelectedRule}"
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  SelectionMode="Single"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  Margin="5">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Listen Port" Binding="{Binding ListenPort}" Width="100"/>
                <DataGridTextColumn Header="Listen Address" Binding="{Binding ListenAddress}" Width="150"/>
                <DataGridTextColumn Header="Forward Port" Binding="{Binding ForwardPort}" Width="100"/>
                <DataGridTextColumn Header="Forward Address" Binding="{Binding ForwardAddress}" Width="150"/>
                <DataGridTextColumn Header="Protocol" Binding="{Binding ProtocolString}" Width="100"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="3">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusText}"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Text="{Binding RuleCountText}"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>